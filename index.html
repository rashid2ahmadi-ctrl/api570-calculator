<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú¯Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù„ÙˆÙ„Ù‡ (API 570 - 4 Ù†Ù‚Ø·Ù‡)</title>
    <style>
        body {
            font-family: 'Tahoma', sans-serif;
            background: #f0f4f8;
            color: #2c3e50;
            padding: 30px;
            max-width: 800px;
            margin: auto;
            line-height: 1.6;
        }
        .logo {
            text-align: center;
            margin-bottom: 20px;
        }
        h1 {
            text-align: center;
            color: #2980b9;
            margin-bottom: 20px;
        }
        .subtitle {
            text-align: center;
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
        }
        .date-group {
            display: flex;
            gap: 10px;
        }
        .date-group input {
            width: 33%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }
        .four-points {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .four-points input {
            width: calc(25% - 7px);
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }
        input[type="number"] {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }
        button {
            margin-top: 25px;
            padding: 12px;
            background-color: #2980b9;
            color: white;
            border: none;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            border-radius: 5px;
            transition: background 0.3s ease;
        }
        button:hover {
            background-color: #1c5980;
        }
        .result {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            font-size: 16px;
            line-height: 1.8;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .safe { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .warning { background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
        .danger { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            border: 1px solid #f5c6cb;
            display: none;
        }
        .print-button {
            background-color: #28a745;
            margin-top: 10px;
        }
        .print-button:hover {
            background-color: #1e7e34;
        }
        .signatures {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            direction: rtl;
        }
        .signature-box {
            border-top: 1px solid #000;
            padding-top: 10px;
            width: 30%;
            text-align: center;
            font-size: 14px;
        }
        .signature-title {
            font-weight: bold;
            margin-bottom: 40px;
        }
        @media print {
            body {
                padding: 10px;
                background: white;
                color: black;
                max-width: 100%;
            }
            button, .print-button {
                display: none;
            }
            .result {
                box-shadow: none;
                border: 1px solid #ccc;
            }
            .result {
                word-wrap: break-word;
            }
            .report-header {
                text-align: center;
                margin-bottom: 20px;
            }
            .report-table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 30px;
                font-size: 14px;
            }
            .report-table th, .report-table td {
                border: 1px solid #000;
                padding: 8px;
                text-align: right;
            }
            .report-table th {
                background-color: #e0e0e0;
            }
            .signatures {
                display: flex;
                justify-content: space-between;
                margin-top: 50px;
                direction: rtl;
            }
            .signature-box {
                border-top: 1px solid #000;
                padding-top: 10px;
                width: 30%;
                text-align: center;
                font-size: 12px;
            }
        }
        .report-content {
            display: none;
        }
    </style>
</head>
<body>
<!-- Ù„ÙˆÚ¯Ùˆ -->
<div class="logo">
    <img src="QeshmMovalled_Logo.png" alt="Ù„ÙˆÚ¯Ùˆ Ù‚Ø´Ù… Ù…ÙˆÙ„Ø§Ø¯" style="max-width: 200px;">
</div>
<h1>Ø­Ù„Ú¯Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù„ÙˆÙ„Ù‡ (API 570)</h1>
<p class="subtitle">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¨Ø§ 4 Ù†Ù‚Ø·Ù‡ Ø¶Ø®Ø§Ù…Øª Ùˆ ØªØ§Ø±ÛŒØ® Ú©Ø§Ù…Ù„ (Ø±ÙˆØ²/Ù…Ø§Ù‡/Ø³Ø§Ù„)</p>
<h3>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø·Ø±Ø§Ø­ÛŒ Ù„ÙˆÙ„Ù‡</h3>
<label>Ù‚Ø·Ø± Ø®Ø§Ø±Ø¬ÛŒ Ù„ÙˆÙ„Ù‡ (D) Ø¨Ù‡ Ø§ÛŒÙ†Ú†</label>
<input type="number" id="D" step="0.1" readonly>
<label>ÙØ´Ø§Ø± Ø·Ø±Ø§Ø­ÛŒ (P) Ø¨Ù‡ psi</label>
<input type="number" id="P" step="1" readonly>
<label>ØªÙ†Ø´ Ù…Ø¬Ø§Ø² (S) Ø¨Ù‡ psi</label>
<input type="number" id="S" step="100" readonly>
<label>Ø¶Ø±ÛŒØ¨ Ø¬ÙˆØ´ (E)</label>
<input type="number" id="E" step="0.01" readonly>
<label>Ø¶Ø±ÛŒØ¨ W</label>
<input type="number" id="W" step="0.01" readonly>
<label>Ø¶Ø±ÛŒØ¨ Y</label>
<input type="number" id="Y" step="0.01" readonly>
<label>Ø­Ø¯Ø§Ù‚Ù„ Ø¶Ø®Ø§Ù…Øª Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² (t_min)</label>
<input type="number" id="tMin" step="0.001" readonly>
<h3>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ±Ø¯Ú¯ÛŒ Ùˆ Ø¨Ø§Ø²Ø±Ø³ÛŒ</h3>
<label>Ø¶Ø®Ø§Ù…Øª Ù‚Ø¨Ù„ÛŒ (t_previous) - Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† 4 Ù†Ù‚Ø·Ù‡</label>
<input type="number" id="tPrevious" step="0.001" readonly>
<label>ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø²Ø±Ø³ÛŒ Ù‚Ø¨Ù„ÛŒ (Ø±ÙˆØ²/Ù…Ø§Ù‡/Ø³Ø§Ù„)</label>
<div class="date-group">
    <input type="number" id="prevDay" placeholder="Ø±ÙˆØ²" min="1" max="31" readonly>
    <input type="number" id="prevMonth" placeholder="Ù…Ø§Ù‡" min="1" max="12" readonly>
    <input type="number" id="prevYear" placeholder="Ø³Ø§Ù„" min="1900" max="2100" readonly>
</div>
<label>Ø¶Ø®Ø§Ù…Øª ÙØ¹Ù„ÛŒ â€” 4 Ù†Ù‚Ø·Ù‡ Ø¯Ø± ÛŒÚ© Ù…ÙˆØ¶Ø¹ (CML)</label>
<div class="four-points">
    <input type="number" id="t1" placeholder="Ù†Ù‚Ø·Ù‡ 1" step="0.001">
    <input type="number" id="t2" placeholder="Ù†Ù‚Ø·Ù‡ 2" step="0.001">
    <input type="number" id="t3" placeholder="Ù†Ù‚Ø·Ù‡ 3" step="0.001">
    <input type="number" id="t4" placeholder="Ù†Ù‚Ø·Ù‡ 4" step="0.001">
</div>
<label>ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø²Ø±Ø³ÛŒ ÙØ¹Ù„ÛŒ (Ø±ÙˆØ²/Ù…Ø§Ù‡/Ø³Ø§Ù„)</label>
<div class="date-group">
    <input type="number" id="currDay" placeholder="Ø±ÙˆØ²" min="1" max="31">
    <input type="number" id="currMonth" placeholder="Ù…Ø§Ù‡" min="1" max="12">
    <input type="number" id="currYear" placeholder="Ø³Ø§Ù„" min="1900" max="2100" value="2024">
</div>
<button onclick="calculateDirect()">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†Ø±Ø® Ø®ÙˆØ±Ø¯Ú¯ÛŒ Ùˆ ÙˆØ¶Ø¹ÛŒØª Ù„ÙˆÙ„Ù‡</button>
<div id="error" class="error"></div>
<div id="output" class="result" style="display: none;"></div>
<button id="printButton" class="print-button" style="display: none;" onclick="printReport()">ğŸ–¨ï¸ Ú†Ø§Ù¾ Ú¯Ø²Ø§Ø±Ø´</button>

<!-- Ù…Ø­ØªÙˆØ§ÛŒ Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù¾ -->
<div id="reportContent" class="report-content">
    <div class="report-header">
        <h2>Ú¯Ø²Ø§Ø±Ø´ Ù†ØªØ§ÛŒØ¬ Ù…Ø­Ø§Ø³Ø¨Ø§Øª API 570</h2>
        <p>ØªØ§Ø±ÛŒØ® Ú¯Ø²Ø§Ø±Ø´: <span id="reportDate"></span></p>
    </div>
    <table class="report-table">
        <tr>
            <th>Ù¾Ø§Ø±Ø§Ù…ØªØ±</th>
            <th>Ù…Ù‚Ø¯Ø§Ø±</th>
            <th>ÙˆØ§Ø­Ø¯</th>
        </tr>
        <tr>
            <td>Ù‚Ø·Ø± Ø®Ø§Ø±Ø¬ÛŒ Ù„ÙˆÙ„Ù‡ (D)</td>
            <td id="reportD"></td>
            <td>Ø§ÛŒÙ†Ú†</td>
        </tr>
        <tr>
            <td>ÙØ´Ø§Ø± Ø·Ø±Ø§Ø­ÛŒ (P)</td>
            <td id="reportP"></td>
            <td>psi</td>
        </tr>
        <tr>
            <td>ØªÙ†Ø´ Ù…Ø¬Ø§Ø² (S)</td>
            <td id="reportS"></td>
            <td>psi</td>
        </tr>
        <tr>
            <td>Ø¶Ø±ÛŒØ¨ Ø¬ÙˆØ´ (E)</td>
            <td id="reportE"></td>
            <td>-</td>
        </tr>
        <tr>
            <td>Ø¶Ø±ÛŒØ¨ W</td>
            <td id="reportW"></td>
            <td>-</td>
        </tr>
        <tr>
            <td>Ø¶Ø±ÛŒØ¨ Y</td>
            <td id="reportY"></td>
            <td>-</td>
        </tr>
        <tr>
            <td>Ø­Ø¯Ø§Ù‚Ù„ Ø¶Ø®Ø§Ù…Øª Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² (t_min)</td>
            <td id="reportTMin"></td>
            <td>Ø§ÛŒÙ†Ú†</td>
        </tr>
        <tr>
            <td>Ø¶Ø®Ø§Ù…Øª Ù‚Ø¨Ù„ÛŒ (Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† 4 Ù†Ù‚Ø·Ù‡)</td>
            <td id="reportTPrevious"></td>
            <td>Ø§ÛŒÙ†Ú†</td>
        </tr>
        <tr>
            <td>Ø¶Ø®Ø§Ù…Øª ÙØ¹Ù„ÛŒ (Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† 4 Ù†Ù‚Ø·Ù‡)</td>
            <td id="reportTActual"></td>
            <td>Ø§ÛŒÙ†Ú†</td>
        </tr>
        <tr>
            <td>Ù†Ø±Ø® Ø®ÙˆØ±Ø¯Ú¯ÛŒ (CR)</td>
            <td id="reportCR"></td>
            <td>Ø§ÛŒÙ†Ú†/Ø³Ø§Ù„</td>
        </tr>
        <tr>
            <td>Ø·ÙˆÙ„ Ø¹Ù…Ø± Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡</td>
            <td id="reportRemainingLife"></td>
            <td>Ø³Ø§Ù„</td>
        </tr>
        <tr>
            <td>Ø¯ÙˆØ±Ù‡ Ø¨Ø§Ø²Ø±Ø³ÛŒ Ø¨Ø¹Ø¯ÛŒ (API 570)</td>
            <td id="reportInspectionInterval"></td>
            <td>Ø³Ø§Ù„</td>
        </tr>
        <tr>
            <td>ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø²Ø±Ø³ÛŒ Ø¨Ø¹Ø¯ÛŒ</td>
            <td id="reportNextInspectionYear"></td>
            <td>Ø³Ø§Ù„</td>
        </tr>
        <tr>
            <td>ÙˆØ¶Ø¹ÛŒØª Ù„ÙˆÙ„Ù‡</td>
            <td id="reportStatus"></td>
            <td>-</td>
        </tr>
    </table>
    <div class="signatures">
        <div class="signature-box">
            <div class="signature-title">Ù…Ø³Ø¦ÙˆÙ„ Ø¨Ø§Ø²Ø±Ø³ÛŒ</div>
            <div>Ø§Ù…Ø¶Ø§: ....................</div>
            <div>ØªØ§Ø±ÛŒØ®: ....................</div>
        </div>
        <div class="signature-box">
            <div class="signature-title">Ù†Ù‡Ø§Ø¯ Ù†Ø§Ø¸Ø±</div>
            <div>Ø§Ù…Ø¶Ø§: ....................</div>
            <div>ØªØ§Ø±ÛŒØ®: ....................</div>
        </div>
        <div class="signature-box">
            <div class="signature-title">Ù†Ù‡Ø§Ø¯ ØªØ§ÛŒÛŒØ¯ Ú©Ù†Ù†Ø¯Ù‡</div>
            <div>Ø§Ù…Ø¶Ø§: ....................</div>
            <div>ØªØ§Ø±ÛŒØ®: ....................</div>
        </div>
    </div>
</div>

<script>
    function dateToYearFraction(day, month, year) {
        if (!day || !month || !year) return null;
        const date = new Date(year, month - 1, day);
        if (isNaN(date.getTime())) return null;
        const yearStart = new Date(date.getFullYear(), 0, 0);
        const diff = date - yearStart;
        const oneDay = 1000 * 60 * 60 * 24;
        return date.getFullYear() + (diff / oneDay / 365.25);
    }
    function avg(arr) {
        return arr.reduce((a, b) => a + b, 0) / arr.length;
    }
    let calculationResults = {};

    function calculateDirect() {
        const fields = {
            D: parseFloat(document.getElementById("D").value),
            P: parseFloat(document.getElementById("P").value),
            S: parseFloat(document.getElementById("S").value),
            E: parseFloat(document.getElementById("E").value),
            W: parseFloat(document.getElementById("W").value),
            Y: parseFloat(document.getElementById("Y").value),
            tMin: parseFloat(document.getElementById("tMin").value),
            tPrevious: parseFloat(document.getElementById("tPrevious").value)
        };
        const prevDay = parseInt(document.getElementById("prevDay").value);
        const prevMonth = parseInt(document.getElementById("prevMonth").value);
        const prevYear = parseInt(document.getElementById("prevYear").value);
        const t1 = parseFloat(document.getElementById("t1").value);
        const t2 = parseFloat(document.getElementById("t2").value);
        const t3 = parseFloat(document.getElementById("t3").value);
        const t4 = parseFloat(document.getElementById("t4").value);
        const currDay = parseInt(document.getElementById("currDay").value);
        const currMonth = parseInt(document.getElementById("currMonth").value);
        const currYear = parseInt(document.getElementById("currYear").value);

        const errorDiv = document.getElementById("error");
        errorDiv.style.display = "none";

        // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ
        if (isNaN(t1) || isNaN(t2) || isNaN(t3) || isNaN(t4)) {
            errorDiv.style.display = "block";
            errorDiv.innerHTML = "âŒ Ù„Ø·ÙØ§Ù‹ Û´ Ù†Ù‚Ø·Ù‡ Ø¶Ø®Ø§Ù…Øª ÙØ¹Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.";
            return;
        }
        if (isNaN(prevDay) || isNaN(prevMonth) || isNaN(prevYear)) {
            errorDiv.style.display = "block";
            errorDiv.innerHTML = "âš ï¸ ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø²Ø±Ø³ÛŒ Ù‚Ø¨Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.";
            return;
        }

        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø¶Ø®Ø§Ù…Øª ÙØ¹Ù„ÛŒ
        const tActual = avg([t1, t2, t3, t4]);

        // ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ® Ø¨Ù‡ Ø¹Ø¯Ø¯ Ø§Ø¹Ø´Ø§Ø±ÛŒ
        const prevDecimal = dateToYearFraction(prevDay, prevMonth, prevYear);
        const currDecimal = dateToYearFraction(currDay, currMonth, currYear);

        if (!prevDecimal || !currDecimal || currDecimal <= prevDecimal) {
            errorDiv.style.display = "block";
            errorDiv.innerHTML = "âš ï¸ ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø²Ø±Ø³ÛŒ Ù‚Ø¨Ù„ÛŒ Ø¨Ø§ÛŒØ¯ Ø§Ø² ÙØ¹Ù„ÛŒ Ú©ÙˆÚ†Ú©ØªØ± Ø¨Ø§Ø´Ø¯.";
            return;
        }

        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†Ø±Ø® Ø®ÙˆØ±Ø¯Ú¯ÛŒ (CR)
        const CR = (fields.tPrevious - tActual) / (currDecimal - prevDecimal);
        if (CR <= 0) {
            errorDiv.style.display = "block";
            errorDiv.innerHTML = "âš ï¸ Ù†Ø±Ø® Ø®ÙˆØ±Ø¯Ú¯ÛŒ Ù†Ø¨Ø§ÛŒØ¯ ØµÙØ± ÛŒØ§ Ù…Ù†ÙÛŒ Ø¨Ø§Ø´Ø¯. Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯.";
            return;
        }

        // Ø¹Ù…Ø± Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡
        const remainingLife = (tActual - fields.tMin) / CR;

        // Ø¯ÙˆØ±Ù‡ Ø¨Ø§Ø²Ø±Ø³ÛŒ Ø¨Ø¹Ø¯ÛŒ (API 570)
        const inspectionInterval = Math.min(remainingLife / 2, 10);

        // ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø²Ø±Ø³ÛŒ Ø¨Ø¹Ø¯ÛŒ
        const nextInspectionYear = currYear + Math.floor(inspectionInterval);

        // ÙˆØ¶Ø¹ÛŒØª Ù„ÙˆÙ„Ù‡
        let status = "Ø§ÛŒÙ…Ù†";
        let statusClass = "safe";
        if (tActual < fields.tMin) {
            status = "Ù†Ø§Ø§ÛŒÙ…Ù†";
            statusClass = "danger";
        } else if (inspectionInterval < 3) {
            status = "Ø¯Ø± Ø¢Ø³ØªØ§Ù†Ù‡ Ø®Ø·Ø±";
            statusClass = "warning";
        }

        // Ø°Ø®ÛŒØ±Ù‡ Ù†ØªØ§ÛŒØ¬
        calculationResults = {
            fields,
            tActual,
            CR,
            remainingLife,
            inspectionInterval,
            nextInspectionYear,
            status,
            statusClass
        };

        // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬
        const output = document.getElementById("output");
        output.className = "result " + statusClass;
        output.innerHTML = `
            <strong>ğŸ“ Ø¶Ø®Ø§Ù…Øª ÙØ¹Ù„ÛŒ (Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† 4 Ù†Ù‚Ø·Ù‡):</strong> ${tActual.toFixed(3)} Ø§ÛŒÙ†Ú†<br>
            <strong>ğŸ“Š Ù†Ø±Ø® Ø®ÙˆØ±Ø¯Ú¯ÛŒ (CR):</strong> ${CR.toFixed(6)} Ø§ÛŒÙ†Ú†/Ø³Ø§Ù„<br>
            <strong>â³ Ø¹Ù…Ø± Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡:</strong> ${remainingLife.toFixed(1)} Ø³Ø§Ù„<br>
            <strong>ğŸ“… Ø¯ÙˆØ±Ù‡ Ø¨Ø§Ø²Ø±Ø³ÛŒ Ø¨Ø¹Ø¯ÛŒ (API 570):</strong> ${inspectionInterval.toFixed(1)} Ø³Ø§Ù„<br>
            <strong>ğŸ“† ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø²Ø±Ø³ÛŒ Ø¨Ø¹Ø¯ÛŒ:</strong> ${nextInspectionYear}<br>
            <strong>ğŸ“Œ ÙˆØ¶Ø¹ÛŒØª Ù„ÙˆÙ„Ù‡:</strong> ${status}
        `;
        output.style.display = "block";
        document.getElementById("printButton").style.display = "block";
    }

    function printReport() {
        document.getElementById("reportDate").textContent = new Date().toLocaleDateString('fa-IR');
        document.getElementById("reportD").textContent = calculationResults.fields.D.toFixed(4);
        document.getElementById("reportP").textContent = calculationResults.fields.P.toFixed(4);
        document.getElementById("reportS").textContent = calculationResults.fields.S.toFixed(4);
        document.getElementById("reportE").textContent = calculationResults.fields.E.toFixed(4);
        document.getElementById("reportW").textContent = calculationResults.fields.W.toFixed(4);
        document.getElementById("reportY").textContent = calculationResults.fields.Y.toFixed(4);
        document.getElementById("reportTMin").textContent = calculationResults.fields.tMin.toFixed(4);
        document.getElementById("reportTPrevious").textContent = calculationResults.fields.tPrevious.toFixed(4);
        document.getElementById("reportTActual").textContent = calculationResults.tActual.toFixed(4);
        document.getElementById("reportCR").textContent = calculationResults.CR.toFixed(6);
        document.getElementById("reportRemainingLife").textContent = calculationResults.remainingLife.toFixed(2);
        document.getElementById("reportInspectionInterval").textContent = calculationResults.inspectionInterval.toFixed(2);
        document.getElementById("reportNextInspectionYear").textContent = calculationResults.nextInspectionYear;
        document.getElementById("reportStatus").textContent = calculationResults.status;

        const reportContent = document.getElementById("reportContent");
        const originalBody = document.body.innerHTML;
        document.body.innerHTML = reportContent.innerHTML;
        window.print();
        document.body.innerHTML = originalBody;
        document.getElementById("printButton").addEventListener("click", printReport);
    }

    // ØªØ§Ø¨Ø¹ Ø¬Ø¯ÛŒØ¯: Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø§Ø² URL
    function getUrlParams() {
        const urlParams = new URLSearchParams(window.location.search);
        return {
            D: urlParams.get('D'),
            P: urlParams.get('P'),
            S: urlParams.get('S'),
            E: urlParams.get('E'),
            W: urlParams.get('W'),
            Y: urlParams.get('Y'),
            tMin: urlParams.get('tMin'),
            tPrevious: urlParams.get('tPrevious'),
            prevDay: urlParams.get('prevDay'),
            prevMonth: urlParams.get('prevMonth'),
            prevYear: urlParams.get('prevYear'),
            currDay: urlParams.get('currDay'),
            currMonth: urlParams.get('currMonth'),
            currYear: urlParams.get('currYear'),
            t1: urlParams.get('t1'),
            t2: urlParams.get('t2'),
            t3: urlParams.get('t3'),
            t4: urlParams.get('t4')
        };
    }

    // ØªØ§Ø¨Ø¹ Ø¬Ø¯ÛŒØ¯: Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ùˆ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡
    function loadAndCalculate() {
        const params = getUrlParams();
        Object.keys(params).forEach(key => {
            const el = document.getElementById(key);
            if (el && params[key]) el.value = params[key];
        });

        // Ø§Ú¯Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¶Ø®Ø§Ù…Øª ÙØ¹Ù„ÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù‡ØŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø³ØªÙ‚ÛŒÙ… Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†
        if (params.t1 && params.t2 && params.t3 && params.t4) {
            setTimeout(calculateDirect, 100); // Ú©Ù…ÛŒ ØªØ£Ø®ÛŒØ± Ø¨Ø±Ø§ÛŒ Ù¾Ø± Ø´Ø¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§
        }
    }

    // ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ÙˆÙ‚ØªÛŒ ØµÙØ­Ù‡ Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯
    window.onload = loadAndCalculate;
</script>
</body>
</html>
delete index.html
